# Tested OS: Windows Server 2019

# Step 1: Define the username for the Guest account
$guestAccount = "Guest"

# Step 2: Get the Guest account object
# Using Get-LocalUser cmdlet to retrieve the account information
$guestUser = Get-LocalUser -Name $guestAccount

# Check if the Guest account exists and is currently disabled
if ($guestUser -and $guestUser.Enabled -eq $false) {
    # Step 3: Enable the Guest account
    # Set-LocalUser cmdlet is used to modify user account properties
    Set-LocalUser -Name $guestAccount -Enabled $true
    
    # Step 4: Provide feedback to the user
    Write-Host "The Guest account has been successfully enabled."
} else {
    # If the account is already enabled or does not exist, provide appropriate feedback
    if ($guestUser -eq $null) {
        Write-Host "The Guest account does not exist on this system."
    } else {
        Write-Host "The Guest account is already enabled."
    }
}
